# RUBI CHAT PRO - –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–µ–π –∑–≤–æ–Ω–∫–æ–≤

## –û–ü–ò–°–ê–ù–ò–ï –ü–†–û–ï–ö–¢–ê

**RUBI Chat PRO** - —ç—Ç–æ –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–æ–≥ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã RUBI Chat —Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π **—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ –∑–≤–æ–Ω–∫–æ–≤**. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª–æ–º –ø—Ä–æ–¥–∞–∂ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AI-–∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è:

- –ö–æ–Ω—Ç—Ä–æ–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è KPI
- –ê—É–¥–∏—Ç–∞ –≤–æ—Ä–æ–Ω–∫–∏ –ø—Ä–æ–¥–∞–∂
- **–û—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∑–≤–æ–Ω–∫–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–µ–π**
- –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –ø–ª–∞–Ω–∞ –ø—Ä–æ–¥–∞–∂
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤

---

## –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –°–ò–°–¢–ï–ú–´

### 1. –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏

```
RUBI CHAT PRO
‚îú‚îÄ‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –û–ü (Dashboard)
‚îÇ   ‚îú‚îÄ‚îÄ KPI –º–µ—Ç—Ä–∏–∫–∏ (–ü–ª–∞–Ω/–§–∞–∫—Ç/–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª)
‚îÇ   ‚îú‚îÄ‚îÄ –¢–∞–±–ª–∏—Ü–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ —Å –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ –ì—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ –≤—ã—Ä—É—á–∫–∏
‚îú‚îÄ‚îÄ –ê—É–¥–∏—Ç –≤–æ—Ä–æ–Ω–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ –¢–∞–±–ª–∏—Ü–∞ —Å–¥–µ–ª–æ–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ –ê–Ω–∞–ª–∏–∑ –∑–¥–æ—Ä–æ–≤—å—è –∫–∞–∂–¥–æ–π —Å–¥–µ–ª–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–±–ª–µ–º
‚îú‚îÄ‚îÄ ‚òî –û–¶–ï–ù–ö–ê –ó–í–û–ù–ö–û–í (–ù–û–í–û–ï)
‚îÇ   ‚îú‚îÄ‚îÄ –ó–∞–≥—Ä—É–∑–∫–∞ –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤ (MP3/WAV)
‚îÇ   ‚îú‚îÄ‚îÄ –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è —Ä–µ—á–∏ –≤ —Ç–µ–∫—Å—Ç
‚îÇ   ‚îú‚îÄ‚îÄ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ø–∏–∫–µ—Ä–æ–≤ (Agent/Client)
‚îÇ   ‚îú‚îÄ‚îÄ –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –∑–≤–æ–Ω–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ –û—Ü–µ–Ω–∫–∞ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º
‚îÇ   ‚îú‚îÄ‚îÄ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ –ò—Å—Ç–æ—Ä–∏—è –∑–≤–æ–Ω–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã
‚îú‚îÄ‚îÄ –ü—É–ª—å—Å —Å–¥–µ–ª–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è —Å–¥–µ–ª–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞
‚îÇ   ‚îî‚îÄ‚îÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–µ–π—Å—Ç–≤–∏—è–º
‚îî‚îÄ‚îÄ AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç
    ‚îú‚îÄ‚îÄ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∏—Å–µ–º/–ö–ü
    ‚îú‚îÄ‚îÄ –ê–Ω–∞–ª–∏–∑ —Å–¥–µ–ª–æ–∫
    ‚îî‚îÄ‚îÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
```

### 2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

**Backend:**
- Python 3.9+
- Streamlit (Web Framework)
- Pandas / NumPy (Data Processing)
- Requests (API Calls)

**Frontend:**
- Streamlit UI Components
- Plotly (Charts)
- Custom CSS

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
- **Bitrix24 API** - –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ CRM –¥–∞–Ω–Ω—ã—Ö
- **Speech-to-Text API** - –¥–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ (OpenAI Whisper, Google Cloud, AssemblyAI, Deepgram)
- **Sentiment Analysis** - –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **Speaker Diarization** - –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ø–∏–∫–µ—Ä–æ–≤

---

## –§–£–ù–ö–¶–ò–Ø –¢–†–ê–ù–°–ö–†–ò–ë–ê–¶–ò–ò –ó–í–û–ù–ö–û–í

### –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã:

```
1. –ó–∞–≥—Ä—É–∑–∫–∞ –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞ (MP3/WAV/OGG)
   ‚Üì
2. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
   ‚Üì
3. –¢–†–ê–ù–°–ö–†–ò–ë–ê–¶–ò–Ø (Speech-to-Text)
   ‚îú‚îÄ‚îÄ –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–∏—Å (Google/OpenAI/AssemblyAI)
   ‚îî‚îÄ‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
   ‚Üì
4. SPEAKER DIARIZATION (–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ø–∏–∫–µ—Ä–æ–≤)
   ‚îú‚îÄ‚îÄ –í—ã–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–ø–ª–∏–∫ –ú–µ–Ω–µ–¥–∂–µ—Ä–∞
   ‚îî‚îÄ‚îÄ –í—ã–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–ø–ª–∏–∫ –ö–ª–∏–µ–Ω—Ç–∞
   ‚Üì
5. –ê–ù–ê–õ–ò–ó –ö–ê–ß–ï–°–¢–í–ê
   ‚îú‚îÄ‚îÄ –û—Ü–µ–Ω–∫–∞ –≤–µ–∂–ª–∏–≤–æ—Å—Ç–∏ (0-5)
   ‚îú‚îÄ‚îÄ –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π (0-5)
   ‚îú‚îÄ‚îÄ –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è (0-5)
   ‚îú‚îÄ‚îÄ –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–¥–µ–ª–∫–∏ (0-5)
   ‚îî‚îÄ‚îÄ –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ (0-20)
   ‚Üì
6. SENTIMENT ANALYSIS (–ê–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏)
   ‚îú‚îÄ‚îÄ –ü–æ–∑–∏—Ç–∏–≤–Ω–∞—è / –ù–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è / –ù–µ–≥–∞—Ç–∏–≤–Ω–∞—è
   ‚îî‚îÄ‚îÄ –£—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
   ‚Üì
7. –ò–ó–í–õ–ï–ß–ï–ù–ò–ï –ö–õ–Æ–ß–ï–í–´–• –§–†–ê–ó
   ‚îú‚îÄ‚îÄ –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
   ‚îî‚îÄ‚îÄ –í—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º/–≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π
   ‚Üì
8. –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò
   ‚îú‚îÄ‚îÄ –ß—Ç–æ —É–ª—É—á—à–∏—Ç—å
   ‚îî‚îÄ‚îÄ –ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞
```

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ API —Å–µ—Ä–≤–∏—Å—ã:

#### **OpenAI Whisper API** (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 99 —è–∑—ã–∫–æ–≤
- –û—Ü–µ–Ω–∫–∞: $0.006 –∑–∞ –º–∏–Ω—É—Ç—É –∞—É–¥–∏–æ
- –°–∞–º–∞—è —Ç–æ—á–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

```python
from openai import OpenAI

client = OpenAI(api_key="sk-...")

with open("call.mp3", "rb") as audio_file:
    transcript = client.audio.transcriptions.create(
        model="whisper-1",
        file=audio_file,
        language="ru"
    )
    print(transcript.text)
```

#### **Google Cloud Speech-to-Text**
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–∞—Ä–∏–∑–∞—Ü–∏–∏ —Å–ø–∏–∫–µ—Ä–æ–≤
- –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —ç–º–æ—Ü–∏–π
- –ë–æ–ª–µ–µ –¥–æ—Ä–æ–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç ($0.024-0.036 –∑–∞ –º–∏–Ω—É—Ç—É)

```python
from google.cloud import speech_v1
import os

os.environ["GOOGLE_APPLICATION_CREDENTIALS"] = "key.json"

client = speech_v1.SpeechClient()

with open("call.wav", "rb") as audio_file:
    content = audio_file.read()

audio = speech_v1.RecognitionAudio(content=content)

config = speech_v1.RecognitionConfig(
    encoding=speech_v1.RecognitionConfig.AudioEncoding.LINEAR16,
    language_code="ru-RU",
    enable_speaker_diarization=True,
    diarization_speaker_count=2
)

response = client.recognize(config=config, audio=audio)

for result in response.results:
    print(result.alternatives[0].transcript)
```

#### **AssemblyAI**
- –ë—ã—Å—Ç—Ä–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —ç–º–æ—Ü–∏–π –∏ —Ç–µ–º
- $0.015 –∑–∞ –º–∏–Ω—É—Ç—É –∞—É–¥–∏–æ

```python
import requests

headers = {
    "authorization": "YOUR_API_KEY"
}

# –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
with open("call.mp3", "rb") as f:
    response = requests.post(
        "https://api.assemblyai.com/v2/upload",
        headers=headers,
        data=f
    )
    audio_url = response.json()["upload_url"]

# –û–±—Ä–∞–±–æ—Ç–∫–∞
response = requests.post(
    "https://api.assemblyai.com/v2/transcript",
    headers=headers,
    json={"audio_url": audio_url}
)

transcript_id = response.json()["id"]

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
while True:
    response = requests.get(
        f"https://api.assemblyai.com/v2/transcript/{transcript_id}",
        headers=headers
    )
    if response.json()["status"] == "completed":
        print(response.json()["text"])
        break
```

---

## –ö–†–ò–¢–ï–†–ò–ò –û–¶–ï–ù–ö–ò –ö–ê–ß–ï–°–¢–í–ê –ó–í–û–ù–ö–ê

### 1. –í–µ–∂–ª–∏–≤–æ—Å—Ç—å –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∏–∑–º (0-5)
- ‚úì –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- ‚úì –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç—É
- ‚úì –í–µ–∂–ª–∏–≤—ã–π —Ç–æ–Ω –æ–±—â–µ–Ω–∏—è
- ‚úì –°–æ–±–ª—é–¥–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –∫–æ–º–ø–∞–Ω–∏–∏
- ‚úó –ì—Ä—É–±–æ—Å—Ç—å, —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ

### 2. –ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π (0-5)
- ‚úì –ê–∫—Ç–∏–≤–Ω–æ–µ —Å–ª—É—à–∞–Ω–∏–µ
- ‚úì –ó–∞–¥–∞–Ω–∏–µ —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
- ‚úì –í—ã—è–≤–ª–µ–Ω–∏–µ "–±–æ–ª–µ–≤—ã—Ö —Ç–æ—á–µ–∫"
- ‚úì –ê–¥–µ–∫–≤–∞—Ç–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤
- ‚úó –ú–æ–Ω–æ–ª–æ–≥ –±–µ–∑ –¥–∏–∞–ª–æ–≥–∞

### 3. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è (0-5)
- ‚úì –ß–µ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥–∏/–ø—Ä–æ–¥—É–∫—Ç–∞
- ‚úì –°–≤—è–∑—å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ —Å –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º–∏
- ‚úì –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–æ–≤
- ‚úì –Ø—Å–Ω–æ—Å—Ç—å –æ–±—ä—è—Å–Ω–µ–Ω–∏—è
- ‚úó –†–∞–∑–º—ã—Ç–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### 4. –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–¥–µ–ª–∫–∏ (0-5)
- ‚úì –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
- ‚úì –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ä–æ–∫–æ–≤
- ‚úì –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–∏—è –∫–ª–∏–µ–Ω—Ç–∞
- ‚úì –î–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –æ –ö–ü/–≤—Å—Ç—Ä–µ—á–µ
- ‚úó –û—Ç–∫—Ä—ã—Ç–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –±–µ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞: —Å—É–º–º–∞ –≤—Å–µ—Ö –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ (0-20)

**–ü–æ—Ä–æ–≥–∏ –æ—Ü–µ–Ω–æ–∫:**
- 18-20: –û—Ç–ª–∏—á–Ω—ã–π –∑–≤–æ–Ω–æ–∫ üü¢ (–ó–µ–ª—ë–Ω—ã–π)
- 14-17: –•–æ—Ä–æ—à–∏–π –∑–≤–æ–Ω–æ–∫ üü° (–ñ—ë–ª—Ç—ã–π)
- 10-13: –°—Ä–µ–¥–Ω–∏–π –∑–≤–æ–Ω–æ–∫ üü† (–û—Ä–∞–Ω–∂–µ–≤—ã–π)
- 5-9: –ü–ª–æ—Ö–æ–π –∑–≤–æ–Ω–æ–∫ üî¥ (–ö—Ä–∞—Å–Ω—ã–π)
- 0-4: –û—á–µ–Ω—å –ø–ª–æ—Ö–æ–π –∑–≤–æ–Ω–æ–∫ ‚ö´ (–ß—ë—Ä–Ω—ã–π)

---

## –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° BITRIX24

### –ó–∞–≥—Ä—É–∑–∫–∞ –∑–≤–æ–Ω–∫–æ–≤ –∏–∑ Bitrix24

```python
import requests

BITRIX_WEBHOOK = "https://YOUR_DOMAIN.bitrix24.ru/rest/1/USER_TOKEN/"

def get_calls_from_bitrix():
    """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π –∑–≤–æ–Ω–∫–æ–≤ –∏–∑ Bitrix24"""
    
    url = BITRIX_WEBHOOK + "crm.activity.list.json"
    
    params = {
        "filter[SUBJECT]": "–ó–≤–æ–Ω–æ–∫",
        "filter[TYPE_ID]": "1",  # Phone call
        "select": ["ID", "SUBJECT", "CREATED", "DESCRIPTION", "CALL_ID"]
    }
    
    response = requests.get(url, params=params)
    return response.json().get("result", [])

def get_call_recording_url(call_id):
    """–ü–æ–ª—É—á–∏—Ç—å URL –∑–∞–ø–∏—Å–∏ –∑–≤–æ–Ω–∫–∞"""
    
    url = BITRIX_WEBHOOK + f"telephony.externalcall.finish.json"
    
    response = requests.get(url, params={"CALL_ID": call_id})
    return response.json().get("RECORD_URL")

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
calls = get_calls_from_bitrix()
for call in calls:
    record_url = get_call_recording_url(call["ID"])
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–≤–æ–Ω–æ–∫ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º
```

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ –æ–±—Ä–∞—Ç–Ω–æ –≤ Bitrix24

```python
def save_call_analysis_to_bitrix(call_id, analysis_data):
    """–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –≤ Bitrix24 –∫–∞–∫ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ"""
    
    note_text = f"""
    **–ê–ù–ê–õ–ò–ó –ö–ê–ß–ï–°–¢–í–ê –ó–í–û–ù–ö–ê**
    
    –û—Ü–µ–Ω–∫–∞: {analysis_data['total_score']}/20
    –í–µ–∂–ª–∏–≤–æ—Å—Ç—å: {analysis_data['politeness']}/5
    –ü–æ–Ω–∏–º–∞–Ω–∏–µ: {analysis_data['understanding']}/5
    –†–µ—à–µ–Ω–∏–µ: {analysis_data['solution']}/5
    –ó–∞–∫—Ä—ã—Ç–∏–µ: {analysis_data['closing']}/5
    
    –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: {analysis_data['sentiment']}
    
    –ö–ª—é—á–µ–≤—ã–µ —Ñ—Ä–∞–∑—ã:
    {', '.join(analysis_data['key_phrases'])}
    
    –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    {'. '.join(analysis_data['recommendations'])}
    """
    
    url = BITRIX_WEBHOOK + "crm.activity.add.json"
    
    data = {
        "fields": {
            "OWNER_ID": call_id,
            "OWNER_TYPE_ID": "2",  # Deal
            "TYPE_ID": "4",  # Note
            "DESCRIPTION": note_text,
            "SUBJECT": "–ê–ù–ê–õ–ò–ó –ó–í–û–ù–ö–ê - AI"
        }
    }
    
    response = requests.post(url, json=data)
    return response.json()
```

---

## –ï–ñ–ï–î–ù–ï–í–ù–´–ô –ò –ï–ñ–ï–ù–ï–î–ï–õ–¨–ù–´–ô –û–¢–ß–ï–¢

### –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç (Email)

```
–ï–ñ–ï–î–ù–ï–í–ù–´–ô –û–¢–ß–ï–¢ –ü–û –ó–í–û–ù–ö–ê–ú - 31 –æ–∫—Ç—è–±—Ä—è 2025

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
- –í—Å–µ–≥–æ –∑–≤–æ–Ω–∫–æ–≤: 47
- –°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞: 14.2/20
- –ü–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö: 28 (59.6%)
- –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã—Ö: 15 (31.9%)
- –ù–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö: 4 (8.5%)

üë• –ü–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º:
–ú–µ–Ω–µ–¥–∂–µ—Ä –ò–≤–∞–Ω:    16 –∑–≤–æ–Ω–∫–æ–≤ (—Å—Ä–µ–¥–Ω—è—è 16.3/20) ‚≠ê‚≠ê‚≠ê‚≠ê
–ú–µ–Ω–µ–¥–∂–µ—Ä –ê—Ä—Ç–µ–º:   15 –∑–≤–æ–Ω–∫–æ–≤ (—Å—Ä–µ–¥–Ω—è—è 14.1/20) ‚≠ê‚≠ê‚≠ê
–ú–µ–Ω–µ–¥–∂–µ—Ä –ò—Ä–∏–Ω–∞:   12 –∑–≤–æ–Ω–∫–æ–≤ (—Å—Ä–µ–¥–Ω—è—è 12.5/20) ‚≠ê‚≠ê
–ú–µ–Ω–µ–¥–∂–µ—Ä –ú–∞—Ä–∏—è:    4 –∑–≤–æ–Ω–∫–æ–≤ (—Å—Ä–µ–¥–Ω—è—è 10.2/20) ‚≠ê

üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –∑–∞–≤—Ç—Ä–∞:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–≤–æ–Ω–æ–∫ –ú–∞—Ä–∏—è –æ—Ç 15:30 (–æ—Ü–µ–Ω–∫–∞ 7/20)
2. –ü—Ä–æ–≤–µ—Å—Ç–∏ –∫–æ—É—á–∏–Ω–≥ —Å –ò—Ä–∏–Ω–æ–π –ø–æ –∑–∞–∫—Ä—ã—Ç–∏—é —Å–¥–µ–ª–æ–∫
3. –û—Ç–º–µ—Ç–∏—Ç—å –æ—Ç–ª–∏—á–Ω—É—é —Ä–∞–±–æ—Ç—É –ò–≤–∞–Ω–∞ - 5 –∑–≤–æ–Ω–∫–æ–≤ –Ω–∞ 16+ –±–∞–ª–ª–æ–≤
```

### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç (Analytics)

```
–ï–ñ–ï–ù–ï–î–ï–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–¢–ò–ß–ï–°–ö–ò–ô –û–¢–ß–ï–¢
–ù–µ–¥–µ–ª—è: 25 –æ–∫—Ç—è–±—Ä—è - 31 –æ–∫—Ç—è–±—Ä—è 2025

üìà –î–∏–Ω–∞–º–∏–∫–∞:
–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫:    12 –∑–≤–æ–Ω–∫–æ–≤ (avg 13.8)
–í—Ç–æ—Ä–Ω–∏–∫:        14 –∑–≤–æ–Ω–∫–æ–≤ (avg 14.1)
–°—Ä–µ–¥–∞:          15 –∑–≤–æ–Ω–∫–æ–≤ (avg 14.5)
–ß–µ—Ç–≤–µ—Ä–≥:        13 –∑–≤–æ–Ω–∫–æ–≤ (avg 14.2)
–ü—è—Ç–Ω–∏—Ü–∞:        11 –∑–≤–æ–Ω–∫–æ–≤ (avg 15.1) ‚¨ÜÔ∏è
–°—É–±–±–æ—Ç–∞-–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ: –≤—ã—Ö–æ–¥–Ω—ã–µ

üí∞ –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å –≤—ã—Ä—É—á–∫–æ–π:
- –î–Ω–∏ —Å average score >14: +35% –≤—ã—Ä—É—á–∫–∏
- –î–Ω–∏ —Å average score <13: -15% –≤—ã—Ä—É—á–∫–∏

üëÅÔ∏è –¢—Ä–µ–Ω–¥–∏–Ω–≥–æ–≤—ã–µ –æ—à–∏–±–∫–∏:
1. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π (avg -0.8 –±–∞–ª–ª–∞)
2. –°–ª–∞–±–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ (avg -0.6 –±–∞–ª–ª–∞)
3. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–ª—É—à–∞–Ω–∏—è (avg -0.7 –±–∞–ª–ª–∞)

üìö –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –æ–±—É—á–µ–Ω–∏–µ:
- –ú–æ–¥—É–ª—å "–í—ã—è–≤–ª–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π" - –¥–ª—è –≤—Å–µ—Ö
- –ú–æ–¥—É–ª—å "–ó–∞–∫—Ä—ã—Ç–∏–µ —Å–¥–µ–ª–∫–∏" - –¥–ª—è –ò—Ä–∏–Ω—ã –∏ –ú–∞—Ä–∏–∏
- –ö–æ—É—á–∏–Ω–≥ 1-1 —Å –ò–≤–∞–Ω–æ–º –ø–æ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º
```

---

## –£–°–¢–ê–ù–û–í–ö–ê –ò –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º/—Å–æ–∑–¥–∞–µ–º –ø—Ä–æ–µ–∫—Ç
mkdir rubi-chat-pro
cd rubi-chat-pro

# 2. –°–æ–∑–¥–∞–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv .venv
source .venv/bin/activate  # Linux/Mac
# –∏–ª–∏
.venv\Scripts\activate  # Windows

# 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# 4. –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
echo "BITRIX24_WEBHOOK=https://YOUR_DOMAIN.bitrix24.ru/rest/1/TOKEN/" > .env
echo "OPENAI_API_KEY=sk-..." >> .env
echo "GOOGLE_APPLICATION_CREDENTIALS=path/to/key.json" >> .env

# 5. –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
streamlit run rubi_chat_pro_main.py
```

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Heroku/Railway/Render)

```bash
# 1. –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª Procfile
echo "web: streamlit run rubi_chat_pro_main.py" > Procfile

# 2. –°–æ–∑–¥–∞–µ–º requirements.txt —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

# 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º git
git init
git add .
git commit -m "Initial commit"

# 4. –î–µ–ø–ª–æ–∏–º –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É
# Heroku:
git push heroku main

# Railway:
railway up

# Render:
# –°–æ–∑–¥–∞–µ–º —á–µ—Ä–µ–∑ UI –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
```

---

## –§–ê–ô–õ–û–í–ê–Ø –°–¢–†–£–ö–¢–£–†–ê

```
rubi-chat-pro/
‚îú‚îÄ‚îÄ rubi_chat_pro_main.py          # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env.example                   # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .streamlit/
‚îÇ   ‚îî‚îÄ‚îÄ config.toml               # –ö–æ–Ω—Ñ–∏–≥ Streamlit
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ auth.py                   # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ bitrix_api.py             # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Bitrix24
‚îÇ   ‚îú‚îÄ‚îÄ transcription.py          # –†–∞–±–æ—Ç–∞ —Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ analysis.py               # –ê–Ω–∞–ª–∏–∑ –∑–≤–æ–Ω–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ utils.py                  # –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ mock_managers.json        # Mock –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ mock_deals.json           # Mock —Å–¥–µ–ª–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ mock_calls.json           # Mock –∑–≤–æ–Ω–∫–∏
‚îî‚îÄ‚îÄ README.md                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## –¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Æ

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

```
# Bitrix24
BITRIX24_WEBHOOK=https://your-domain.bitrix24.ru/rest/1/USER_TOKEN/

# OpenAI (Whisper)
OPENAI_API_KEY=sk-...

# Google Cloud (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
GOOGLE_APPLICATION_CREDENTIALS=path/to/key.json

# Sentio (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
SENTIMENTAL_API_KEY=...

# Streamlit –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
STREAMLIT_SERVER_PORT=8501
STREAMLIT_SERVER_HEADLESS=true
STREAMLIT_SERVER_MAXUPLOADSIZE=200
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É

- Python 3.9+
- –ú–∏–Ω–∏–º—É–º 2GB RAM
- –î–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç (–¥–ª—è API –≤—ã–∑–æ–≤–æ–≤)
- SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production)

---

## –î–ê–õ–¨–ù–ï–ô–®–ï–ï –†–ê–ó–í–ò–¢–ò–ï

### v2.0 (–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- [ ] Real-time —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –≤–æ –≤—Ä–µ–º—è –∑–≤–æ–Ω–∫–∞
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- [ ] REST API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- [ ] Multilingual –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (EN, ES, DE, FR)
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF/Excel –æ—Ç—á—ë—Ç–æ–≤
- [ ] Dashboard –≤ Bitrix24 –∫–∞–∫ –≤–∏–¥–∂–µ—Ç

### v2.1
- [ ] Machine Learning –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ—É—á–∏–Ω–≥ –≤–æ –≤—Ä–µ–º—è –∑–≤–æ–Ω–∫–∞ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å HubSpot
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∏–¥–µ–æ-–∑–≤–æ–Ω–∫–æ–≤
- [ ] –ê/–ë —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤

---

## –õ–ò–¶–ï–ù–ó–ò–Ø –ò –ö–û–ù–¢–ê–ö–¢–´

**–ê–≤—Ç–æ—Ä:** RUBI CHAT Team
**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞:** –û–∫—Ç—è–±—Ä—å 2025

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏: support@rubichat.ru
